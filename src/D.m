function w = D(x)
% =========================================================================
% Calculate the 2D gradient (finite difference) of an input image.
% -------------------------------------------------------------------------
% Input:    - x  : The input 2D image.
% Output:   - w  : The gradient (3D array).
% =========================================================================
w = cat(3,x(1:end,:) - x([2:end,end],:),x(:,1:end) - x(:,[2:end,end]));
end


% function u = DTf(w)
% % =========================================================================
% % Calculate the transpose of the gradient operator.
% % -------------------------------------------------------------------------
% % Input:    - w  : 3D array.
% % Output:   - x  : 2D array.
% % =========================================================================
% u1 = w(:,:,1) - w([end,1:end-1],:,1);
% u1(1,:) = w(1,:,1);
% u1(end,:) = -w(end-1,:,1);
% 
% u2 = w(:,:,2) - w(:,[end,1:end-1],2);
% u2(:,1) = w(:,1,2);
% u2(:,end) = -w(:,end-1,2);
% 
% u = u1 + u2;
% end